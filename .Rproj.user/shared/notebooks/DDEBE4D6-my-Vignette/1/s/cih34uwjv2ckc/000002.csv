"0","McpAUC <- function(dataset,  low.value=NULL, up.value=NULL, plot=FALSE, selection = NULL) {"
"0","  St_pAUC <-NULL; pAUC <- NULL; sensitivity <- NULL; FPR <- NULL;"
"0","  fpr.proc<-NULL; sen.proc<-NULL;  up.limit <- NULL; low.limit <- NULL"
"0","  Ap.roc<-NULL;   object <- NULL;par(new=FALSE);  par <- NULL; legend <- NULL; abline <- NULL;"
"0",""
"0","  if (class(dataset)==""RangedSummarizedExperiment"") {"
"0","    strain <- dataset@colData@listData$strain"
"0","    dataset <- as.data.frame(SummarizedExperiment::assay(dataset))"
"0","    dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)"
"0","    name.variable <- colnames(dataset)"
"0","    dataset <- as.data.frame(cbind(strain,dataset))"
"0","  }  else {  dataset <- as.data.frame(dataset)"
"0","  name.variable <- colnames(dataset)"
"0","  }"
"0","  dimension <- dim(dataset)"
"0",""
"0","  if(dimension[2]<2) {stop(""database has to have at least 2 colums"")}"
"0",""
"0",""
"0","  for (i in 2:dimension[2]) {"
"0","    dataset_temporal <- cbind(dataset[,1],dataset[i])"
"0","    sen.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,2]"
"0","    fpr.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,1]"
"0",""
"0","    ## Variables and initial values for the partial area of each ROC curve"
"0","    ### PARTIAL ROC curve (fpr.proc; sen.proc) on [lower.fp <= e <= upper.fp]"
"0",""
"0","    if (!is.null(up.value)){up.limit <- up.value}else{up.limit <- 1}"
"0","    if (!is.null(low.value)){low.limit <- low.value}else{low.limit <- 0}"
"0","    fpr.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,1]"
"0","    sen.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,2]"
"0",""
"0","    ### TYPE OF PORTION ROC curve on [lower.fp <= e <= upper.fp]"
"0",""
"0","    ### BOUNDS FOR PARTIAL AREA INDEXES: MIN & MAX boundaries for TpAUC index"
"0","    St_pAUC[[i-1]] <- MCpA(sen.proc,fpr.proc)"
"0","    pAUC[[i-1]] <- as.vector(pA(fpr.proc,sen.proc))"
"0","    sensitivity[[i-1]] <-as.vector(sen.proc)"
"0","    FPR[[i-1]] <- as.vector(fpr.proc)"
"0","    if (isTRUE(plot)) {plot(sen.roc~fpr.roc, type=""l"", col=i, ylab=""TPR"", xlab=""FPR"")"
"0","      legend(x= ""bottomright"",legend = name.variable[1:i-1], fill = 2:i, cex = 0.8)"
"0","      abline(a=c(0,1),lwd=1, col=""grey"")"
"0","      abline(v=low.value,col=""black"")"
"0","      abline(v=up.value,col=""black"")"
"0","      par(new=TRUE)"
"0",""
"0","    }"
"0",""
"0","  }"
"0",""
"0","  object <- list(St_pAUC, pAUC, sensitivity, FPR)"
"0","  names <- c(""St_pAUC"",""pAUC"", ""Sensitivity"", ""FPR"")"
"0","  se <- createSE(object, names)"
"0","  return(se)"
"0","}"
"0",""
