for (i in 2:dim(bsdata)[2]) {
bsdata_temp <- cbind(bsdata[,1],bsdata[,i])
sen.roc<- points_curve(bsdata_temp[,1],bsdata_temp[,2])[,2]
fpr.roc<- points_curve(bsdata_temp[,1],bsdata_temp[,2])[,1]
fpr.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,1]
sen.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,2]
SpAUC[i-1] <- MCpA(sen.proc,fpr.proc)
}
return(SpAUC)
}
createSE <- function(object, names){
names(object) <- names
names <- names
data.matrix <- as.matrix(object)
#cambiar
se=SummarizedExperiment::SummarizedExperiment(assays=data.matrix,
colData<-MultiAssayExperiment::DataFrame(metrics = (names)))
names(se@assays$data@listData[[1]]) <- names
return(se)
}
library(fission)
library(ROCpAI)
data("fission")
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c")]
genes <- cbind(strain,fission.genes.10)
colnames(genes) <- c("Strain", "Gene1", "Gene2", "Gene3", "Gene4", "Gene5"  )
genes
points_curve<-function(x, y){
xsample <- NULL; ysample <- NULL
xsample <- cbind(x[which(is.na(x)==FALSE & is.na(y)==FALSE)])
ysample <- y[which(is.na(x)==FALSE & is.na(y)==FALSE)]
points<-NULL; pre.point<-NULL; fpr.point<-NULL; sen.point<-NULL; xy<-NULL
points<-sort(ysample)
points<-append(points[-length(points)]+diff(points)/2, min(points)-1, 0)
points<-append(points, max(ysample)+1, length(points))
for (point in points) {
pre.point<-(ysample>point)*1
fpr.point[which(points == point)]<-sum((pre.point == 1)*(xsample == 1))/sum(xsample == 1)
sen.point[which(points == point)]<-sum((pre.point == 1)*(xsample == 2))/sum(xsample == 2)
}
if (is.unsorted(sen.point)) {
sen.point<-rev(sen.point)
fpr.point<-rev(fpr.point)}
xy<-cbind(fpr.point, sen.point)
return(xy)
}
points_curve(genes[,1], genes[,2])
McpAUC <- function(dataset,  low.value=NULL, up.value=NULL, plot=FALSE, selection = NULL) {
St_pAUC <-NULL; pAUC <- NULL; sensitivity <- NULL; FPR <- NULL;
fpr.proc<-NULL; sen.proc<-NULL;  up.limit <- NULL; low.limit <- NULL
Ap.roc<-NULL;   object <- NULL; par(new=F);
if (class(dataset)=="RangedSummarizedExperiment") {
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(fission@colData@listData$strain,t(dataset[selection,])))
} else {  dataset <- as.data.frame(dataset)
name.variable <- colnames(dataset)
}
dimension <- dim(dataset)
if(dimension[2]<2) {stop("database has to have at least 2 colums")}
for (i in 2:dimension[2]) {
dataset_temporal <- cbind(dataset[,1],dataset[i])
sen.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,2]
fpr.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,1]
## Variables and initial values for the partial area of each ROC curve
### PARTIAL ROC curve (fpr.proc; sen.proc) on [lower.fp <= e <= upper.fp]
if (!is.null(up.value)){up.limit <- up.value}else{up.limit <- 1}
if (!is.null(low.value)){low.limit <- low.value}else{low.limit <- 0}
fpr.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,1]
sen.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,2]
### TYPE OF PORTION ROC curve on [lower.fp <= e <= upper.fp]
#warning("Improper ROC curve on partial region: min.pauc<-(e2^2-e1^2)/2>pAUC")
#warning("PORTION ROC curve over partial plr")
### BOUNDS FOR PARTIAL AREA INDEXES: MIN & MAX boundaries for TpAUC index
St_pAUC[[i-1]] <- MCpA(sen.proc,fpr.proc)
pAUC[[i-1]] <- as.vector(pA(fpr.proc,sen.proc))
sensitivity[[i-1]] <-as.vector(sen.proc)
FPR[[i-1]] <- as.vector(fpr.proc)
if (isTRUE(plot)) {plot(sen.roc~fpr.roc, type="l", col=i, ylab="TPR", xlab="FPR")
legend(x= "bottomright",legend = name.variable[2:i], fill = 2:i, cex = 0.8)
abline(a=c(0,1),lwd=1, col="grey")
abline(v=low.value,col="black")
abline(v=up.value,col="black")
par(new=T)
}
}
object <- list(St_pAUC, pAUC, sensitivity, FPR)
names <- c("St_pAUC","pAUC", "Sensitivity", "FPR")
se <- createSE(object, names)
return(se)
}
resultMc <- McpAUC(genes, low.value = 0, up.value = 0.25, plot=TRUE)
resultMc
test.Mc<- assay(resultMc)
test.Mc$St_pAUC
test.Mc$pAUC
TpAUC <- function(dataset,  low.value = NULL, up.value = NULL, plot = FALSE, selection = NULL ) {
St_pAUC <-NULL; pAUC <- NULL; sensitivity <- NULL; FPR <- NULL;
fpr.proc<-NULL; sen.proc<-NULL;  up.limit <- NULL; low.limit <- NULL
Ap.roc<-NULL;   object <- NULL;par(new=F);
## Variables and initial values for each sample<-ROC curve
if (class(dataset)=="RangedSummarizedExperiment") {
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(fission@colData@listData$strain,t(dataset[selection,])))
} else {  dataset <- as.data.frame(dataset)
name.variable <- colnames(dataset)
}
dimension <- dim(dataset)
if(dimension[2]<2) {stop("database has to have at least 2 colums")}
for (i in 2:dimension[2]) {
dataset_temporal <- cbind(dataset[,1],dataset[i])
sen.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,2]
fpr.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,1]
if (!is.null(up.value)){up.limit <- up.value}else{up.limit <- 1}
if (!is.null(low.value)){low.limit <- low.value}else{low.limit <- 0}
fpr.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,1]
sen.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,2]
St_pAUC[[i-1]] <- TpA(fpr.proc,sen.proc)
pAUC[[i-1]] <- as.vector(pA(fpr.proc,sen.proc))
sensitivity[[i-1]] <-as.vector(sen.proc)
FPR[[i-1]] <- as.vector(fpr.proc)
if (isTRUE(plot)) {plot(sen.roc~fpr.roc, type="l", col=i, ylab="TPR", xlab="FPR")
legend(x= "bottomright",legend = name.variable[2:i], fill = 2:i, cex = 0.8)
abline(a=c(0,1),lwd=1, col="grey")
abline(v=low.value,col="black")
abline(v=up.value,col="black")
par(new=T)
}
}
object <- list(St_pAUC, pAUC, sensitivity, FPR)
names <- c("St_pAUC","pAUC", "Sensitivity", "FPR")
se <- createSE(object, names)
return(se)
}
resultsT <- TpAUC(genes, low.value = 0, up.value = 0.25, plot=TRUE)
TpAUC <- function(dataset,  low.value = NULL, up.value = NULL, plot = FALSE, selection = NULL ) {
St_pAUC <-NULL; pAUC <- NULL; sensitivity <- NULL; FPR <- NULL;
fpr.proc<-NULL; sen.proc<-NULL;  up.limit <- NULL; low.limit <- NULL
Ap.roc<-NULL;   object <- NULL;par(new=F);
## Variables and initial values for each sample<-ROC curve
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
} else {  dataset <- as.data.frame(dataset)
name.variable <- colnames(dataset)
}
dimension <- dim(dataset)
if(dimension[2]<2) {stop("database has to have at least 2 colums")}
for (i in 2:dimension[2]) {
dataset_temporal <- cbind(dataset[,1],dataset[i])
sen.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,2]
fpr.roc<- points_curve(dataset_temporal[,1],dataset_temporal[,2])[,1]
if (!is.null(up.value)){up.limit <- up.value}else{up.limit <- 1}
if (!is.null(low.value)){low.limit <- low.value}else{low.limit <- 0}
fpr.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,1]
sen.proc <- portion_ROC(up.limit, low.limit, fpr.roc,sen.roc)[,2]
St_pAUC[[i-1]] <- TpA(fpr.proc,sen.proc)
pAUC[[i-1]] <- as.vector(pA(fpr.proc,sen.proc))
sensitivity[[i-1]] <-as.vector(sen.proc)
FPR[[i-1]] <- as.vector(fpr.proc)
if (isTRUE(plot)) {plot(sen.roc~fpr.roc, type="l", col=i, ylab="TPR", xlab="FPR")
legend(x= "bottomright",legend = name.variable[2:i], fill = 2:i, cex = 0.8)
abline(a=c(0,1),lwd=1, col="grey")
abline(v=low.value,col="black")
abline(v=up.value,col="black")
par(new=T)
}
}
object <- list(St_pAUC, pAUC, sensitivity, FPR)
names <- c("St_pAUC","pAUC", "Sensitivity", "FPR")
se <- createSE(object, names)
return(se)
}
resultsT <- TpAUC(genes, low.value = 0, up.value = 0.25, plot=TRUE)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
strain
dataset[selection,]
dataset
data("fission")
strain <- fission@colData@listData$strain
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
selection <- c("SPNCRNA.1080","SPAC186.08c")
TpAUC(dataset,low.value = 0, up.value = 0.25, plot = TRUE)
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
selection <- c("SPNCRNA.1080","SPAC186.08c")
selection
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
dataset
TpAUC(dataset,low.value = 0, up.value = 0.25, plot = TRUE)
data("fission")
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c")]
genes <- cbind(strain,fission.genes.10)
resultsT <- TpAUC(genes, low.value = 0, up.value = 0.25, plot = TRUE)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
genes
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c")
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
dataset
genes
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
genes
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
data("fission")
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
fission.genes.10
genes <- cbind(strain,fission.genes.10)
genes
TpAUC(fission.genes.10,low.value = 0, up.value = 0.25, plot = TRUE)
TpAUC(genes,low.value = 0, up.value = 0.25, plot = TRUE)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
genes
dataset
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
dataset <- as.data.frame(cbind(strain,t(dataset[selection,])))
dataset
genes
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset
scale(as.matrix(dataset), center=TRUE, scale = TRUE)
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
dataset <- scale(as.matrix(dataset[selection,]), center=TRUE, scale = TRUE)
dataset
dataset <- as.data.frame(cbind(strain,t(dataset)))
dataset
genes
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- scale(as.matrix(as.data.frame(SummarizedExperiment::assay(fission))[selection,]), center=TRUE, scale = TRUE)
dataset
dataset <- as.data.frame(cbind(strain,t(dataset)))
dataset
genes
fission.genes.10
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10
as.data.frame(SummarizedExperiment::assay(fission))[selection,])
as.data.frame(SummarizedExperiment::assay(fission))[selection,]
t(as.matrix(as.data.frame(SummarizedExperiment::assay(fission))[selection,]))
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10
dataset <- as.data.frame(cbind(strain,dataset))
dataset
dataset <- scale(t(as.matrix(as.data.frame(SummarizedExperiment::assay(fission))[selection,])), center=TRUE, scale = TRUE)
dataset
dataset <- as.data.frame(cbind(strain,dataset))
dataset
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
genes
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
library(ROCpIA)
data("fission")
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
TpAUC(genes,low.value = 0, up.value = 0.25, plot = TRUE)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
fission
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
library(ROCpIA)
data("fission")
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
class(fission)
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,dataset))
}
dataset <- fission
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset)
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,dataset))
}
dataset
TpAUC(genes,low.value = 0, up.value = 0.25, plot = TRUE)
TpAUC(genes,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c","SPAC212.04c"))
resultsT
fission
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE)
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080"))
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE,
selection = c(1,2))
name.variable <- colnames(dataset[selection,])
name.variable
strain <- dataset@colData@listData$strain
data("fission")
dataset <- fission
strain <- dataset@colData@listData$strain
strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
dataset
name.variable <- colnames(dataset[selection,])
name.variable
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
selection
name.variable <- colnames(dataset[selection,])
name.variable
dataset[selection,])
dataset[selection,]
dataset[,selection]
dataset
dataset[selection,]
as.matrix(dataset[selection,]
as.matrix(dataset[selection,])
as.matrix(dataset[selection,])
t(as.matrix(dataset[selection,]))
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
as.data.frame(cbind(strain,dataset)
as.data.frame(cbind(strain,dataset))
as.data.frame(cbind(strain,dataset))
library(ROCpIA)
detach("package:ROCpIA", unload = TRUE)
detach("package:ROCpAI", unload = TRUE)
library(ROCpAI)
data("fission")
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
library(ROCpAI)
data("fission")
library(fission)
data("fission")
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
fission
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080"))
library(ROCpAI)
library(ROCpAI)
library(ROCpAI)
library(fission)
data("fission")
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
selection = c(SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
dataset <- fission
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset[selection,])
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,dataset))
}
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset[selection,])
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,dataset))
}
dataset
library(ROCpAI)
library(fission)
data("fission")
TpAUC(fission,low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c"))
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE,
selection = c("SPNCRNA.1080"))
x <- assay(resultT)
x <- assay(resultsT)
x$St_pAUC
x$St_pAUC
fission.expresion <- assay(fission)
fission.expresion <- t(fission.expresion)
strain <- fission@colData@listData$strain
fission.genes.10 <- fission.expresion[,c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")]
fission.genes.10 <- scale(as.matrix(fission.genes.10), center=TRUE, scale = TRUE)
genes <- cbind(strain,fission.genes.10)
TpAUC(genes,low.value = 0, up.value = 0.25, plot = TRUE)
if (class(dataset)=="RangedSummarizedExperiment") {
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset[selection,])
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
dataset <- as.data.frame(cbind(strain,dataset))
}
dataset <- fission
strain <- dataset@colData@listData$strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
name.variable <- colnames(dataset[selection,])
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
name.variable <- colnames(dataset[selection,])
dataset
name.variable <- colnames(dataset)
name.variable
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
resultsMC <- McpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
library(ROCpAI)
library(ROCpAI)
library(fission)
data("fission")
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
resultsMC <- McpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
selection <- c("SPNCRNA.1080","SPAC186.08c","SPNCRNA.1420","SPCC70.08c")
dataset <- fission
strain <- dataset@colData@listData$strain
strain
dataset <- as.data.frame(SummarizedExperiment::assay(dataset))
dataset <- scale(t(as.matrix(dataset[selection,])), center=TRUE, scale = TRUE)
name.variable <- colnames(dataset)
name.variable
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
library(ROCpAI)
library(ROCpAI)
library(fission)
data("fission")
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
resultstboot<- TpAUCboot(fission,low.value = 0, up.value = 0.25, seed = 1234, selection = c("SPNCRNA.1080","SPAC186.08c"))
resultsMCboot <- MCpAUCboot(fission,low.value = 0, up.value = 0.25, seed = 1234, selection = c("SPNCRNA.1080","SPAC186.08c"))
library(ROCpAI)
BiocManager::library("fission")
BiocManager::install("fission")
library(MultiAssayExperiment)
library(ROCpAI)
library(fission)
library(ROCpAI)
data("fission")
data("fission")
resultsT <- TpAUC(fission, low.value = 0, up.value = 0.25, plot = TRUE, selection = c("SPNCRNA.1080","SPAC186.08c"))
resultsT
strain <- dataset@colData@listData$strain
dataset <- fission
strain <- dataset@colData@listData$strain
strain
pointsCurve<- points_curve(strain, assay(fussion)[,"SPNCRNA.1080"])
pointsCurve<- points_curve(strain, assay(fission)[,"SPNCRNA.1080"])
assay(fission)
pointsCurve<- points_curve(strain, t(assay(fission))[,"SPNCRNA.1080"])
pointsCurve
strain <- dataset@colData@listData$strain
